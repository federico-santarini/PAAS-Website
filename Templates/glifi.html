{% extends 'base.html' %}

{% block content %}
  <h1>PAAS Website - Glifi</h1>

  <form id="glyph-filter-form" method="GET">
    {% csrf_token %}
    {{ FORM.as_p }}
  </form>

  <form id="glyph-downloadall-form" action="{% url 'download_all_images' %}">
    <input type="submit" value="Scarica tutti i glifi" />
  </form>

  <ul>
    {% for glyph in SELECTED_GLYPHS %}
      <li>"{{ glyph.foreignGlyph.parola }}"</li>
    {% endfor %}
  </ul>

<form id="glyph-selection-form" method="post" action="{% url 'glifi' %}">
    {% csrf_token %}
      {% for glyph in GLYPHS %}
      <div style="float: left; width: 10%;">
          <input id="{{ glyph.id }}" type="checkbox" name="selected_images" value="{{ glyph.id }}" />
          <img src="{{ glyph.glyphFile.url }}" alt="{{ glyph.parola }}" />
        </div>
          {% endfor %}
      
  </form>

  {% comment %} <form id="glyph-downloadSelection-form" action="{% url 'download_selected_images' %}">
    <input type="submit" value="Scarica i glifi selezionati" />
  </form> {% endcomment %}
  <a href="{% url 'download_selected_images' %}">download_selected_images</a>

  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

  <script>
    $(document).ready(function () {
      const form = $('#glyph-filter-form')
    
      $("input[type='checkbox']", form).on('change', function () {
        form.submit()
      })
    })
  </script>
  <script>
    $(document).ready(function () {
      const form = $('#glyph-selection-form')
    
      $("input[type='checkbox']", form).on('change', function () {
        form.submit()
      })
    })
  </script>  

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="http://cdn.jsdelivr.net/jquery.cookie/1.4.0/jquery.cookie.min.js"></script>

 {% comment %} <script>
  $(".checkAllClass").on("change", function() {
    $('.checkboxClass').not(this).prop('checked', this.checked);
  });
  
  $(".checkboxClass").on("change", function(){
    var checkboxValues = {};
    $(".checkboxClass").each(function(){
      checkboxValues[this.id] = this.checked;
    });
    $.cookie('checkboxValues', checkboxValues, { expires: 7, path: '/' });
  });
  
  function repopulateCheckboxes(){
    var checkboxValues = $.cookie('checkboxValues');
    if(checkboxValues){
      Object.keys(checkboxValues).forEach(function(element) {
        var checked = checkboxValues[element];
        $("#" + element).prop('checked', checked);
      });
    }
  }
  
  $.cookie.json = true;
  repopulateCheckboxes();
  
</script> {% endcomment %}
{% endblock %}
